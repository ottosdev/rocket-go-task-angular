@let todoTasks = (_taskService.todoTasks | async) ?? [];
@let doingTasks = (_taskService.doingTasks | async) ?? [];
@let doneTasks = (_taskService.doneTasks | async) ?? [];

@if (!todoTasks.length && !doingTasks.length && !doneTasks.length) {
  <div class="bg-[#fafafa] rounded-sm py-3 px-5 border-l-4 border-black">
    <p class="font-semibold text-lg text-[#9ca3af]">Nenhuma tarefa disponível no momento</p>
  </div>
} @else {
  <div class="p-3 mb-6 flex overflow-x-auto scrollbar-hidden">
    <!-- Colunas A fazer -->
    <div
      cdkDropList
      id="to-do-column"
      #todoListCdkDropList="cdkDropList"
      [cdkDropListData]="todoTasks"
      [cdkDropListConnectedTo]="[doingListCdkDropList, doneListCdkDropList]"
      (cdkDropListDropped)="onCardDrop($event)"
      class="py-3 px-6 min-w-60 flex-1 flex flex-col gap-6"
    >
      <div class="py-2 border-b border-[#d1d5db] flex items-center gap-1">
        <h1 class="font-bold">A fazer</h1>
        <span class="text-xs font-semibold text-white bg-black py-1 px-2 rounded-xl">{{
          todoTasks.length
        }}</span>
      </div>
      <div class="flex flex-col gap-4">
        <!-- Tarefas -->
        @for (todo of todoTasks; track todo.id) {
          <app-task-card cdkDrag [cdkDragData]="todo" [task]="todo" />
        }
      </div>
    </div>
    <!-- Colunas Fazendo -->
    <div
      cdkDropList
      id="doing-column"
      #doingListCdkDropList="cdkDropList"
      [cdkDropListData]="doingTasks"
      [cdkDropListConnectedTo]="[todoListCdkDropList, doneListCdkDropList]"
      (cdkDropListDropped)="onCardDrop($event)"
      class="py-3 px-6 min-w-60 flex-1 flex flex-col gap-6"
    >
      <div class="py-2 border-b border-[#d1d5db] flex items-center gap-1">
        <h1 class="font-bold">Fazendo</h1>
        <span class="text-xs font-semibold text-white bg-[#ff850a] py-1 px-2 rounded-xl">{{
          doingTasks.length
        }}</span>
      </div>
      <div class="flex flex-col gap-4">
        <!-- Tarefas -->
        @for (doingTask of doingTasks; track doingTask.id) {
          <app-task-card cdkDrag [cdkDragData]="doingTask" [task]="doingTask" />
        }
      </div>
    </div>
    <!-- Coluna Concluido -->
    <div
      cdkDropList
      id="done-column"
      #doneListCdkDropList="cdkDropList"
      [cdkDropListData]="doneTasks"
      [cdkDropListConnectedTo]="[todoListCdkDropList, doingListCdkDropList]"
      (cdkDropListDropped)="onCardDrop($event)"
      class="py-3 px-6 min-w-60 flex-1 flex flex-col gap-6"
    >
      <div class="py-2 border-b border-[#d1d5db] flex items-center gap-1">
        <h1 class="font-bold">Concluído</h1>
        <span class="text-xs font-semibold text-white bg-[#1cbe78] py-1 px-2 rounded-xl">{{
          doneTasks.length
        }}</span>
      </div>
      <div class="flex flex-col gap-4">
        <!-- Tarefas -->
        @for (done of doneTasks; track done.id) {
          <app-task-card cdkDrag [cdkDragData]="done" [task]="done" />
        }
      </div>
    </div>
  </div>
}
